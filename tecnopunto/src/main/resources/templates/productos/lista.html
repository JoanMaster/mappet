<!DOCTYPE html> 
<html xmlns:th="http://www.thymeleaf.org"> 
<body> 
    <div th:replace="layout :: layout(~{::section})"> 
        <section> 
            <div class="d-flex justify-content-between align-items-center mb-3"> 
                <h2>Lista de Productos</h2> 
                <a th:href="@{/productos/nuevo}" class="btn btn-success">+ Nuevo Producto</a> 
            </div> 

            
            <!-- Información de productos --> 
            <div class="mb-2" th:if="${totalElements > 0}"> 
                <small class="text-muted"> 
                    Mostrando 
                    <span th:text="${currentPage * 10 + 1}">1</span> - 
                    <span th:text="${currentPage * 10 + productos.numberOfElements}">10</span> 
                    de <span th:text="${totalElements}">50</span> productos 
                </small> 
            </div> 
            

            <!-- Tabla de productos --> 
            <table class="table table-striped table-bordered shadow-sm"> 
                <thead class="table-dark"> 
                    <tr> 
                        <th>ID</th> 
                        <th>Nombre</th> 
                        <th>Precio</th> 
                        <th>Acciones</th> 
                    </tr> 
                </thead> 
                <tbody> 
                    <tr th:each="producto : ${productos}"> 
                        <td th:text="${producto.id}"></td> 
                        <td th:text="${producto.nombre}"></td> 
                        <td th:text="${'$' + #numbers.formatDecimal(producto.precio, 1, 2)}"></td> 
                        <td> 
                            <a th:href="@{'/productos/editar/' + ${producto.id}}" 
                                class="btn btn-warning btn-sm me-2">Editar</a> 

                            
                            <!-- Botón abrir modal --> 
                            <button type="button" class="btn btn-danger btn-sm" 
                                    data-bs-toggle="modal" 
                                    th:data-bs-target="'#eliminarModal' + ${producto.id}"> 

                                Eliminar 
                            </button> 
                        

                            <!-- Modal Bootstrap --> 
                            <div class="modal fade" th:id="'eliminarModal' + ${producto.id}" tabindex="-1" aria-hidden="true"> 
                                <div class="modal-dialog modal-dialog-centered"> 
                                    <div class="modal-content"> 
                                        <div class="modal-header bg-danger text-white"> 
                                            <h5 class="modal-title">Confirmar eliminación</h5> 
                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button> 
                                        </div> 
                                        <div class="modal-body"> 
                                            ¿Seguro que deseas eliminar el producto 
                                            <strong th:text="${producto.nombre}"></strong>? 
                                        </div> 
                                        <div class="modal-footer"> 
                                            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button> 
                                            <a th:href="@{'/productos/eliminar/' + ${producto.id}}" class="btn btn-danger">Eliminar</a> 
                                        </div> 
                                    </div> 
                                </div> 
                            </div> 
                            <!-- Fin modal --> 
                        </td> 
                    </tr> 
                </tbody> 
            </table> 

            
            <!-- Mensaje si no hay productos --> 
            <div th:if="${totalElements == 0}" class="text-center py-4"> 
                <p class="text-muted">No hay productos registrados.</p> 
                <a th:href="@{/productos/nuevo}" class="btn btn-primary">Agregar primer producto</a> 
            </div> 

            
            <!-- Paginación Bootstrap --> 
            <nav aria-label="Navegación de productos" th:if="${totalPages > 1}"> 
                <ul class="pagination justify-content-center"> 
                    
                    <!-- Botón Anterior --> 
                    <li class="page-item" th:classappend="${!hasPrevious} ? 'disabled'"> 
                        <a class="page-link" th:href="@{/productos(page=${currentPage - 1})}" 
                            th:if="${hasPrevious}"> 
                            <span aria-hidden="true">&laquo;</span> Anterior 
                        </a> 
                        <span class="page-link text-muted" th:unless="${hasPrevious}"> 
                            <span aria-hidden="true">&laquo;</span> Anterior 
                        </span> 
                    </li> 

                    

                    <!-- Primera página (si no estamos cerca del inicio) --> 
                    <li class="page-item" th:if="${currentPage > 2}"> 
                        <a class="page-link" th:href="@{/productos(page=0)}">1</a> 
                    </li> 

                    
                    <!-- Puntos suspensivos al inicio --> 
                    <li class="page-item disabled" th:if="${currentPage > 3}"> 
                        <span class="page-link">...</span> 
                    </li> 

                    
                    <!-- Páginas alrededor de la actual --> 
                    <th:block th:each="pageNum : ${#numbers.sequence( 
                        T(java.lang.Math).max(0, currentPage - 2), 
                        T(java.lang.Math).min(totalPages - 1, currentPage + 2) 
                    )}"> 
                        <li class="page-item" th:classappend="${pageNum == currentPage} ? 'active'"> 
                            <a class="page-link" th:href="@{/productos(page=${pageNum})}" 
                                th:text="${pageNum + 1}">1</a> 
                        </li> 
                    </th:block> 
                    

                    <!-- Puntos suspensivos al final --> 
                    <li class="page-item disabled" th:if="${currentPage < totalPages - 4}"> 
                        <span class="page-link">...</span> 
                    </li> 

                    
                    <!-- Última página (si no estamos cerca del final) --> 
                    <li class="page-item" th:if="${currentPage < totalPages - 3}"> 
                        <a class="page-link" th:href="@{/productos(page=${totalPages - 1})}" 
                            th:text="${totalPages}">Last</a> 
                    </li> 
                    

                    <!-- Botón Siguiente --> 
                    <li class="page-item" th:classappend="${!hasNext} ? 'disabled'"> 
                        <a class="page-link" th:href="@{/productos(page=${currentPage + 1})}" 
                            th:if="${hasNext}"> 
                            Siguiente <span aria-hidden="true">&raquo;</span> 
                        </a> 
                        <span class="page-link text-muted" th:unless="${hasNext}"> 
                            Siguiente <span aria-hidden="true">&raquo;</span> 
                        </span> 
                    </li> 
                </ul> 
            </nav> 

    
            <!-- Información de paginación al final --> 
            <div class="text-center mt-3" th:if="${totalElements > 0}"> 
                <small class="text-muted"> 
                    Página <span th:text="${currentPage + 1}">1</span> de <span th:text="${totalPages}">5</span> 
                    | Total: <span th:text="${totalElements}">50</span> productos 
                </small> 
            </div> 
    

        </section> 
    </div> 
</body> 
</html> 
 